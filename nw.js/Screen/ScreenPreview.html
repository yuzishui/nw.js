<html>
  <head>
    <meta http-equiv="Content-Type" content="text/html" charset="utf-8" />
  </head>
  <body style="font-size:12px">
    <p id="1"># Screen {: .doctitle}</p>
    <p id="2">---</p>
    <p id="3">[TOC]</p>
    <p id="4">`Screen` is an instance of EventEmitter object, and you're able to use `Screen.on(...)` to respond to native screen's events.</p>
    <p id="5">`Screen` is a singleton object, need to be initiated once by calling `nw.Screen.Init()`</p>
    <p id="6">## Synopsis</p>
    <p id="7">```javascript</p>
    <p id="8">//init must be called once during startup, before any function to nw.Screen can be called</p>
    <p id="9">nw.Screen.Init();</p>
    <p id="10">var screenCB = {</p>
    <p id="11">  onDisplayBoundsChanged: function(screen) {</p>
    <p id="12">    console.log('displayBoundsChanged', screen);</p>
    <p id="13">  },</p>
    <p id="14">  onDisplayAdded: function(screen) {</p>
    <p id="15">    console.log('displayAdded', screen);</p>
    <p id="16">  },</p>
    <p id="17">  onDisplayRemoved: function(screen) {</p>
    <p id="18">    console.log('displayRemoved', screen)</p>
    <p id="19">  }</p>
    <p id="20">};</p>
    <p id="21">// listen to screen events</p>
    <p id="22">nw.Screen.on('displayBoundsChanged', screenCB.onDisplayBoundsChanged);</p>
    <p id="23">nw.Screen.on('displayAdded', screenCB.onDisplayAdded);</p>
    <p id="24">nw.Screen.on('displayRemoved', screenCB.onDisplayRemoved);</p>
    <p id="25">```</p>
    <p id="26">## Screen.Init()</p>
    <p id="27">Init the Screen singleton object, you only need to call this once</p>
    <p id="28">## Screen.screens</p>
    <p id="29">Get the array of screen (number of screen connected to the computer)</p>
    <p id="30">screen has following structure:</p>
    <p id="31">```javascript</p>
    <p id="32">screen {</p>
    <p id="33">// unique id for a screen</p>
    <p id="34">  id: int,</p>
    <p id="35">// physical screen resolution, can be negative, not necessarily start from 0,depending on screen arrangement</p>
    <p id="36">  bounds: {</p>
    <p id="37">    x: int,</p>
    <p id="38">    y: int,</p>
    <p id="39">    width: int,</p>
    <p id="40">    height: int</p>
    <p id="41">  },</p>
    <p id="42">// useable area within the screen bound</p>
    <p id="43">  work_area: {</p>
    <p id="44">    x: int,</p>
    <p id="45">    y: int,</p>
    <p id="46">    width: int,</p>
    <p id="47">    height: int</p>
    <p id="48">  },</p>
    <p id="49">  scaleFactor: float,</p>
    <p id="50">  isBuiltIn: bool,</p>
    <p id="51">  rotation: int,</p>
    <p id="52">  touchSupport: int</p>
    <p id="53">}</p>
    <p id="54">```</p>
    <p id="55">## Screen.chooseDesktopMedia (sources, callback)</p>
    <p id="56">* `sources` `{String[]}` array of source types. Two types are supported by this API: `"screen"` and `"window"`.</p>
    <p id="57">* `callback` `{Function}` callback function with chosed streamId. streamId will be `false` if failed to execute or existing session is alive.</p>
    <p id="58">!!! note</p>
    <p id="59">    Screen sharing by selection; Currently only working in Windows and OSX and some linux distribution.</p>
    <p id="60">Example:</p>
    <p id="61">```javascript</p>
    <p id="62">nw.Screen.Init(); // you only need to call this once</p>
    <p id="63">nw.Screen.chooseDesktopMedia(["window","screen"], </p>
    <p id="64">  function(streamId) {</p>
    <p id="65">    var vid_constraint = {</p>
    <p id="66">      mandatory: {</p>
    <p id="67">        chromeMediaSource: 'desktop', </p>
    <p id="68">        chromeMediaSourceId: streamId, </p>
    <p id="69">        maxWidth: 1920, </p>
    <p id="70">        maxHeight: 1080</p>
    <p id="71">      }, </p>
    <p id="72">      optional: []</p>
    <p id="73">    };</p>
    <p id="74">    navigator.webkitGetUserMedia({audio: false, video: constraint}, success_func, fallback_func);</p>
    <p id="75">  }</p>
    <p id="76">);</p>
    <p id="77">```</p>
    <p id="78">## Event: displayBoundsChanged(screen)</p>
    <p id="79">Emitted when the screen resolution, arrangement is changed, the callback is called with 1 argument `screen`. See [Screen.screens](#screenscreens) for the format.</p>
    <p id="80">## Event: displayAdded (screen)</p>
    <p id="81">Emitted when a new screen added, the callback is called with 1 argument `screen`. See [Screen.screens](#screenscreens) for the format.</p>
    <p id="82">## Event: displayRemoved (screen)</p>
    <p id="83">Emitted when existing screen removed, the callback is called with 1 argument `screen`. See [Screen.screens](#screenscreens) for the format.</p>
    <p id="84">## Screen.DesktopCaptureMonitor</p>
    <p id="85">This API behaves similar functions as `Screen.chooseDesktopMedia`. But it doesn't have GUI. You can use this API to monitor the changes of screens and windows on desktop and implement your own UI.</p>
    <p id="86">`Screen.DesktopCaptureMonitor` is an instance of `EventEmitter`. You can use `Screen.DesktopCaptureMonitor.on()` to listen to the events.</p>
    <p id="87">### Synopsis</p>
    <p id="88">```javascript</p>
    <p id="89">var dcm = nw.Screen.DesktopCaptureMonitor;</p>
    <p id="90">nw.Screen.Init();</p>
    <p id="91">dcm.on("added", function (id, name, order, type) {</p>
    <p id="92">   //select first stream and shutdown</p>
    <p id="93">   var constraints = {</p>
    <p id="94">      audio: {</p>
    <p id="95">         mandatory: {</p>
    <p id="96">             chromeMediaSource: "system",</p>
    <p id="97">             chromeMediaSourceId: dcm.registerStream(id)</p>
    <p id="98">          }</p>
    <p id="99">      },</p>
    <p id="100">      video: {</p>
    <p id="101">         mandatory: {</p>
    <p id="102">             chromeMediaSource: 'desktop',</p>
    <p id="103">             chromeMediaSourceId: dcm.registerStream(id)</p>
    <p id="104">         }</p>
    <p id="105">      }</p>
    <p id="106">  };</p>
    <p id="107">  // TODO: call getUserMedia with contraints</p>
    <p id="108">  dcm.stop();</p>
    <p id="109">});</p>
    <p id="110">dcm.on("removed", function (id) { });</p>
    <p id="111">dcm.on("orderchanged", function (id, new_order, old_order) { });</p>
    <p id="112">dcm.on("namechanged", function (id, name) { });</p>
    <p id="113">dcm.on("thumbnailchanged", function (id, thumbnail) { });</p>
    <p id="114">dcm.start(true, true);</p>
    <p id="115">```</p>
    <p id="116">### Screen.DesktopCaptureMonitor.started</p>
    <p id="117">Boolean of whether the DesktopCaptureMonitor is started.</p>
    <p id="118">### Screen.DesktopCaptureMonitor.start(should_include_screens, should_include_windows)</p>
    <p id="119">* `should_include_screens` `{Boolean}` whether should include screens</p>
    <p id="120">* `should_include_windows` `{Boolean}` whether should include windows</p>
    <p id="121">The `DesktopCaptureMonitor` will start monitoring the system and trigger the the events. The screen may flicker if while `DesktopCaptureMonitor` is running.</p>
    <p id="122">### Screen.DesktopCaptureMonitor.stop()</p>
    <p id="123">The `DesktopCaptureMonitor` will stop monitoring the system. `DesktopCaptureMonitor` should be stopped after a stream is selected.</p>
    <p id="124">### Screen.DesktopCaptureMonitor.registerStream(id)</p>
    <p id="125">Register and return a valid stream id passed into `chromeMediaSourceId` in `getUserMedia` constraints. See [Synopsis](#synopsis_1) for the usage.</p>
    <p id="126">### Event: added (id, name, order, type, primary)</p>
    <p id="127">!!! warning "Behavior Changed"</p>
    <p id="128">    This feature is changed in 0.13.0. See [Migration Notes from 0.12 to 0.13](../For Users/Migration/From 0.12 to 0.13.md).</p>
    <p id="129">* `id` `{String}` is the media id. Use `registerStream(id)` to obtain a valid stream id used with `getUserMedia()`. See [registerStream](#screendesktopcapturemonitorregisterstreamid)</p>
    <p id="130">* `name` `{String}` is the title of the window or screen</p>
    <p id="131">* `order` `{Integer}` is the z-order of the windows, if screens are selected they will appear first</p>
    <p id="132">* `type` `{String}` type of the stream: "screen", "window", "other" or "unknown"</p>
    <p id="133">* `primary` `{Boolean}` _Windows OS only_ this will be `true` if the source is the primary monitor</p>
    <p id="134">Emit when a new source was added.</p>
    <p id="135">### Event: removed (order)</p>
    <p id="136">* `order` `{Integer}` is the order of the media source that is no longer capturable</p>
    <p id="137">Emit when a source was removed.</p>
    <p id="138">### Event: orderchanged (id, new_order, old_order)</p>
    <p id="139">!!! warning "Behavior Changed"</p>
    <p id="140">    This feature is changed in 0.13.0. See [Migration Notes from 0.12 to 0.13](../For Users/Migration/From 0.12 to 0.13.md).</p>
    <p id="141">* `id` `{String}` is the media id of the screen or window that has changed z-order</p>
    <p id="142">* `new_order` `{Integer}` is the new z-order</p>
    <p id="143">* `old_order` `{Integer}` is the old z-order</p>
    <p id="144">Emit when the Z-order of a source changed (this may change for windows as others are focused).</p>
    <p id="145">### Event: namechanged (id, name)</p>
    <p id="146">!!! warning "Behavior Changed"</p>
    <p id="147">    This feature is changed in 0.13.0. See [Migration Notes from 0.12 to 0.13](../For Users/Migration/From 0.12 to 0.13.md).</p>
    <p id="148">* `id` `{String}` is the media id of the screen or window that has a name changed</p>
    <p id="149">* `name` `{String}` is the new new name of the screen or window</p>
    <p id="150">Emit when the name of the source has changed. This can happen when a window changes title.</p>
    <p id="151">### Event: thumbnailchanged (id, thumbnail)</p>
    <p id="152">!!! warning "Behavior Changed"</p>
    <p id="153">    This feature is changed in 0.13.0. See [Migration Notes from 0.12 to 0.13](../For Users/Migration/From 0.12 to 0.13.md).</p>
    <p id="154">* `id` `{String}` is the media id of the screen or window that has an updated thumbnail</p>
    <p id="155">* `thumbnail` `{String}` is the base64 encoded png of the thumbnail</p>
    <p id="156">Emit when the thumbnail of a source changed.</p>
  </body>
</html>